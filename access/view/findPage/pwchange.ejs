<!DOCTYPE html>
<html>
  <head>
    <title>비밀번호재설정</title>
    <link rel="stylesheet" href="view/findPage/find.css">
    <link rel="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
    <!-- <script
        src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic+Coding&display=swap" rel="stylesheet">
  </head>

  <body>
    <div class="container">
      <div class="form-sign-in-container">
        <div id="join_title">
        <h1>비밀번호재설정</h1>
        </div>
        <div class="content mar-top">
          <input
            type="password"
            placeholder="비밀번호"
            id="password"
            name="password"
            class="id"
            maxlength="20"
          />
          </div>
          <!-- 비밀번호 정규식에 맞게 작성되었는지 check -->
          <div class="passwordcheck emailcheck textStart"></div>
            <!-- 비밀번호 확인 -->
          <div class="content">
          <input
            type="password"
            placeholder="비밀번호 확인"
            id="password_a"
            name="cpassword"
            class="id"
            maxlength="20"
          />
          </div>
          <!-- 비밀번호 확인 정규식에 맞게 작성되었는지 check -->
          <div class="passwordre emailcheck textStart"></div>
          <button
            type="submit"
            class="btn"
            disabled="disabled"
          >
            비밀번호 재설정
          </button>
      </div>
      <script>
          //비밀번호 정규식
          document.querySelector("#password").onkeyup = function () {
        let password = this.value;
        let passwordreg =
          /^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,15}$/g;
        //정규식 Pass
        if (passwordreg.test(password)) {
          document.querySelector(".passwordcheck").innerHTML = "";
          b = 1;
          console.log(b);
        //정규식 fail
        } else if (password == "") {
          document.querySelector(".passwordcheck").innerHTML = "";
          b = 0;
          console.log(b);
        //정규식 fail
        } else {
          document.querySelector(".passwordcheck").innerHTML =
            "1개이상의 특수문자 대문자 소문자 숫자를 입력하세요";
          b = 0;
          console.log(b);
        }
      };
      //비밀번호 확인 정규식
      document.querySelector("#password_a").onkeyup = function () {
        let password_a = this.value;
        //정규식 Pass
        if (password_a == password.value) {
          document.querySelector(".passwordre").innerHTML = "";
          c = 1;
          console.log(c);
        //정규식 fail
        } else if (password_a == "") {
          document.querySelector(".passwordre").innerHTML = "";
          c = 0;
          console.log(c);
        //정규식 fail
        } else {
          document.querySelector(".passwordre").innerHTML =
            "패스워드가 동일하지 않습니다.";
          c = 0;
          console.log(c);
        }
      };

      let password = document.querySelector('#password');

      $.ajax({
        url: '/passcha',
        type: 'post',
        data: {
          user: result,
          password: password.value,
        },
        success: function(data){
          if(data === 'success') {
            alert('비밀번호가 변경되었으니 로그인해 주시기 바랍니다.')
            window.close();
          }
        }
      })
      </script>
  </body>
</html>
